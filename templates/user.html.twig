{% extends 'base.html.twig' %}
{% set page_file = 'user' %}
{% set title = user.username ~ "'s Profile" %}
{% block content %}
    <section id="user">
        <aside>
            <article>
                <h1><span>{{ user.username }}</span>'s profile</h1>
                <div id="stats">
                    <div>
                        <div>
                            <h3>Balance</h3>
                            ${{ user.wallet|number_format(2, '.', ',') }}
                        </div>
                        <div>
                            <h3>Account</h3>
                            {% if user.banType != null %}
                                Banned
                            {% elseif user.premium == "activated" %}
                                Premium
                            {% else %}
                                Active
                            {% endif %}
                        </div>
                        <div>
                            <h3>Case points</h3>
                            {{ user.casePoints|number_format(0, '.', ',') }}
                        </div>
                        <div>
                            <h3>Spent</h3>
                            ${{ user.totalSpending|number_format(0, '.', ',') }}
                        </div>
                        <div>
                            <h3>Opened</h3>
                            {{ user.casesOpened|number_format(0, '.', ',')}}
                        </div>
                        <div>
                            <h3>Reds</h3>
                            {{ user.redsOpened|number_format(0, '.', ',') }}
                        </div>
                        <div>
                            <h3>Knives</h3>
                            {{ user.knivesOpened }}
                        </div>
                    </div>
                    <div>
                        <h2>Operation</h2>
                        <div>
                            <h3>Tokens</h3>
                            {{ user.operationTokens }}
                        </div>
                        <div>
                            <h3>Tickets</h3>
                            {{ user.opTickets }}
                        </div>
                        <div>
                            <h3>Completed</h3>
                            {{ user.compOp }}
                        </div>
                    </div>
                </div>
            </article>
            {#
                    <tr>
                        <td>
                            <h4>Last daily</h4>
                            {{ user.dailyClaim }}
                        </td>
                        <td>
                            <h4>Daily streak</h4>
                            {{ user.dailyStreak }}
                        </td>
                    </tr>
            #}
        </aside>
        <div id="inventory">
            <nav>
                <ul>
                    <li><a href="/user/{{ userID }}/skins">Skins</a></li>
                    <li><a href="/user/{{ userID }}/stickers">Stickers</a></li>
                    <li>
                        <button onclick="">Filter by</button>
                        <select name="sort" onchange="updateFilter('sort', this.value);">
                            <option value="default" {% if sort == 'default' %}selected{% endif %}>default</option>
                            <option value="price" {% if sort == 'price' %}selected{% endif %}>price</option>
                            <option value="rarity" {% if sort == 'rarity' %}selected{% endif %}>rarity</option>
                            {% if inventoryType == 'skins' %}
                                <option value="float" {% if sort == 'float' %}selected{% endif %}>float</option>
                            {% endif %}
                        </select>
                    </li>
                    <li>
                        <button onclick="">Order by</button>
                        <select name="sort" onchange="updateFilter('order', this.value);">
                            <option value="asc" {% if order == 'asc' %}selected{% endif %}>ascending</option>
                            <option value="desc" {% if order == 'desc' %}selected{% endif %}>descending</option>
                        </select>
                    </li>
                </ul>
                {% if inventoryType == 'skins' %}
                    <p>${{ user.inventoryValue|number_format(2, '.', ',') }} - {{ user.inventory|length }}/{{ user.inventorySize }} items</p>
                {% else %}
                    <p>$ - {{ user.itemInventory|length }}/25 items</p>
                {% endif %}
            </nav>
            <ul>
                {% set targetInventory = inventoryType == 'skins' ? user.inventory : user.itemInventory %}
                {% for item in targetInventory %}
                    <li class="rarity{{ item.rarity | capitalize }}">
                        <div class="retractedDiv rarity{{ item.rarity | capitalize }}">
                            <figure>
                                <figcaption>
                                    {% if inventoryType == 'skins' %}
                                        <p>Id°{{ loop.index }}</p>
                                        <p>{{ item.float }}</p>
                                        <p>{{ item.case }}</p>
                                        <p>${{ item.price|number_format(2, '.', ',') }}</p>
                                        <p>{{ item.rarity }}</p>
                                    {% else %}
                                        <p>Id°{{ loop.index }}</p>
                                        <p>{{ item.capsule }}</p>
                                        <p>${{ item.price|number_format(2, '.', ',') }}</p>
                                        <p>{{ item.finish }}</p>
                                    {% endif %}
                                </figcaption>
                                <img src="{{ item.link }}" alt="{{ item.name }}">
                            </figure>
                            <figcaption>
                                <h3>{{ item.name }}</h3>
                                <p>{{ item.owner is defined ? item.owner }}</p>
                            </figcaption>
                        </div>
                    </li>
                {% endfor %}
            </ul>
        </div>
    </section>
{% endblock %}
